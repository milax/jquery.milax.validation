/*

jQuery Milax Validation v1.3
jQuery Plugin
Latest Update: 14.11.2012

Author: Eugene Kuzmin
Copyright: 2011-12, Eugene Kuzmin

-----------------------------------------------------------------------*/
(function($){$.fn.mxValidation=function(settings){var options={},$fieldsets=this;var init=function(){hideAllErrorMsgs();function hideAllErrorMsgs(){$fieldsets.each(function(){var $currFieldset=$(this);$currFieldset.find(options.errMsgClass).hide()})}};var fieldBlurHandler=function(e){var $input=$(e.target),errorClass=options.fieldHasErrorClass;errorClass=errorClass.substr(1);if($input.hasClass(errorClass))doFieldsValidation($input)};var fieldKeyUpHandler=function(event){var $fieldset=$(event.delegateTarget),
ENTER_KEY_CODE=13;if(event.keyCode===ENTER_KEY_CODE)$fieldset.find(options.btnSubmitSelector).click()};var submitBtnHandler=function(event){var $btnSubmit=$(this),$fieldset=$(event.delegateTarget),$fields2Validate=$fieldset.find(options.fields2ValidateSelector),valRes=doFieldsValidation($fields2Validate);if(valRes&&typeof options.isValidFunc==="function")options.isValidFunc($btnSubmit,$fieldset);return options.isAnyActionsIfValid?valRes:false};var doFieldsValidation=function($fieldsToValidate){var isValid=
true,validationClasses=new Array("mxRequired","mxEmail","mxNumber","mxMax","mxMin","mxAtLeastOne","mxPostalCode");$fieldsToValidate.each(function(){validateThisField($(this))});return isValid;function validateThisField($input){var i,currClass;$input.closest(options.fieldHolderSelector).find(options.errMsgClass).hide();$input.removeClass(options.fieldHasErrorClass.substr(1));for(i in validationClasses){currClass=validationClasses[i];if($input.hasClass(currClass)&&!isFieldValid(currClass,$input)){isValid=
false;return true}}}};var isFieldValid=function(way,$what2Validate){var val=$.trim($what2Validate.val()),opts=$what2Validate.data("mxvalidateOptions"),$errMsg=$what2Validate.closest(options.fieldHolderSelector).find(options.errMsgClass+"."+way),isValid=true,pattern;pattern=getPattern();switch(way){case "mxRequired":isValid=!!val;break;case "mxEmail":case "mxNumber":isValid=val.match(pattern)!==null;break;case "mxMax":var maxLength=opts.max;isValid=val.length<=maxLength;break;case "mxMin":var minLength=
opts.min;isValid=val.length>=minLength;break;case "mxAtLeastOne":var $checkedCheckboxes=$what2Validate.find('input[type="checkbox"]:checked');isValid=$checkedCheckboxes.length!==0;break;case "mxPostalCode":var postalCode;postalCode=val.replace(/\s/g,"");postalCode=postalCode.replace(/\-/g,"");isValid=postalCode.match(pattern)!==null;break;default:isValid=false}if(!isValid)showErrorMsg($errMsg,$what2Validate);return isValid;function getPattern(){var p;switch(way){case "mxEmail":p=/^[\u00c6\u00d8\u00c5\u00e6\u00f8\u00e5a-zA-Z0-9_-]+(?:\.[\u00c6\u00d8\u00c5\u00e6\u00f8\u00e5a-zA-Z0-9_-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$/;
break;case "mxNumber":p=/^\d*$/;break;case "mxPostalCode":var postalCodeRegexps={"dk":/^\d{4}$/,"da":/^\d{4}$/,"no":/^\d{4}$/,"se":/^\d{5}$/,"sv":/^\d{5}$/,"pl":/^\d{5}$/,"fi":/^\d{5}$/,"en-GB":/(GIR 0AA)|(((A[BL]|B[ABDHLNRSTX]?|C[ABFHMORTVW]|D[ADEGHLNTY]|E[HNX]?|F[KY]|G[LUY]?|H[ADGPRSUX]|I[GMPV]|JE|K[ATWY]|L[ADELNSU]?|M[EKL]?|N[EGNPRW]?|O[LX]|P[AEHLOR]|R[GHM]|S[AEGKLMNOPRSTY]?|T[ADFNQRSW]|UB|W[ADFNRSV]|YO|ZE)[1-9]?[0-9]|((E|N|NW|SE|SW|W)1|EC[1-4]|WC[12])[A-HJKMNPR-Y]|(SW|W)([2-9]|[1-9][0-9])|EC[1-9][0-9]) [0-9][ABD-HJLNP-UW-Z]{2})/,
"en":/(GIR 0AA)|(((A[BL]|B[ABDHLNRSTX]?|C[ABFHMORTVW]|D[ADEGHLNTY]|E[HNX]?|F[KY]|G[LUY]?|H[ADGPRSUX]|I[GMPV]|JE|K[ATWY]|L[ADELNSU]?|M[EKL]?|N[EGNPRW]?|O[LX]|P[AEHLOR]|R[GHM]|S[AEGKLMNOPRSTY]?|T[ADFNQRSW]|UB|W[ADFNRSV]|YO|ZE)[1-9]?[0-9]|((E|N|NW|SE|SW|W)1|EC[1-4]|WC[12])[A-HJKMNPR-Y]|(SW|W)([2-9]|[1-9][0-9])|EC[1-9][0-9]) [0-9][ABD-HJLNP-UW-Z]{2})/,"uk":/(GIR 0AA)|(((A[BL]|B[ABDHLNRSTX]?|C[ABFHMORTVW]|D[ADEGHLNTY]|E[HNX]?|F[KY]|G[LUY]?|H[ADGPRSUX]|I[GMPV]|JE|K[ATWY]|L[ADELNSU]?|M[EKL]?|N[EGNPRW]?|O[LX]|P[AEHLOR]|R[GHM]|S[AEGKLMNOPRSTY]?|T[ADFNQRSW]|UB|W[ADFNRSV]|YO|ZE)[1-9]?[0-9]|((E|N|NW|SE|SW|W)1|EC[1-4]|WC[12])[A-HJKMNPR-Y]|(SW|W)([2-9]|[1-9][0-9])|EC[1-9][0-9]) [0-9][ABD-HJLNP-UW-Z]{2})/,
"com":/(GIR 0AA)|(((A[BL]|B[ABDHLNRSTX]?|C[ABFHMORTVW]|D[ADEGHLNTY]|E[HNX]?|F[KY]|G[LUY]?|H[ADGPRSUX]|I[GMPV]|JE|K[ATWY]|L[ADELNSU]?|M[EKL]?|N[EGNPRW]?|O[LX]|P[AEHLOR]|R[GHM]|S[AEGKLMNOPRSTY]?|T[ADFNQRSW]|UB|W[ADFNRSV]|YO|ZE)[1-9]?[0-9]|((E|N|NW|SE|SW|W)1|EC[1-4]|WC[12])[A-HJKMNPR-Y]|(SW|W)([2-9]|[1-9][0-9])|EC[1-9][0-9]) [0-9][ABD-HJLNP-UW-Z]{2})/};p=postalCodeRegexps[options.locale]||postalCodeRegexps["dk"];break;default:p=""}return p}};var showErrorMsg=function($errorMsg,$what2Validate){$errorMsg.css({display:"block"});
$what2Validate.addClass(options.fieldHasErrorClass.substr(1))};var getLocale=function(){var hostname=window.location.hostname,lang=hostname.match(/\.([a-z,A-Z]{2,6})$/);lang=lang&&lang[1]?lang[1]:"en";return lang};var bindings=function(){$fieldsets.on("keyup",options.fieldsToValidateSelector,fieldKeyUpHandler);$fieldsets.on("focusout",options.fieldsToValidateSelector,fieldBlurHandler);$fieldsets.on("click",options.btnSubmitSelector,submitBtnHandler)};(function(){options=$.extend({errMsgClass:".mxError",
fieldHasErrorClass:".mxNotValidated",fields2ValidateSelector:".mxValidate",btnSubmitSelector:".btnSubmit",fieldHolderSelector:"dd",locale:getLocale(),isValidFunc:false,isAnyActionsIfValid:true},settings),init();bindings()})()}})(jQuery);
